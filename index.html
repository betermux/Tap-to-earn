<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>CS Bomb Simulator (with real SFX)</title>
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <style>
    :root { font-family: system-ui,sans-serif; }
    body   { margin:0; height:100vh; display:flex; flex-direction:column;
            justify-content:center; align-items:center; background:#111; color:#0f0;}
    h1     { margin-bottom:1rem; }
    #display{ font-size:3rem; margin:1rem 0; letter-spacing:2px; }
    button { padding:1rem 2rem; margin:.5rem; font-size:1.1rem; border:none;
             border-radius:8px; cursor:pointer; transition:.2s; }
    #plantButton { background:#c00; color:#fff; }
    #defuseButton{ background:#06c; color:#fff; }
    button:disabled{ opacity:.3; cursor:not-allowed; }
  </style>
</head>
<body>
  <h1>CS Bomb Simulator</h1>
  <div id="display">Hold to PLANT</div>

  <button id="plantButton">Hold to Plant (T)</button>
  <button id="defuseButton" disabled>Hold to Defuse (CT)</button>

  <!-- ------------ Real CS:GO audio assets ------------------------------- -->
  <audio id="audPlanted"  preload="auto"
         src="https://www.myinstants.com/media/sounds/bomb-has-been-planted-sound-effect-cs-go.mp3"></audio> <!-- “Bomb has been planted” --> 
  <audio id="audDefused"  preload="auto"
         src="https://www.myinstants.com/media/sounds/bomb-has-been-defused-csgo-sound-effect.mp3"></audio> <!-- “Bomb has been defused” -->
  <audio id="audCTWin"    preload="auto"
         src="https://www.myinstants.com/media/sounds/counter-terrorists-win.mp3"></audio>              <!-- “Counter-Terrorists win” -->
  <audio id="audExplosion"preload="auto"
         src="https://www.myinstants.com/media/sounds/counter-strike-c4-sound.mp3"></audio>             <!-- Explosion -->
  <audio id="audTWin"     preload="auto"
         src="https://soundfxcenter.com/video-games/counter-strike/8d82b5_Counter_Strike_Terrorists_Win_Sound_Effect.mp3"></audio> <!-- “Terrorists win” -->

  <script>
  // ------------------------- DOM refs -----------------------------------
  const plantBtn  = document.getElementById('plantButton');
  const defuseBtn = document.getElementById('defuseButton');
  const display   = document.getElementById('display');

  const audPlanted   = document.getElementById('audPlanted');
  const audDefused   = document.getElementById('audDefused');
  const audCTWin     = document.getElementById('audCTWin');
  const audExplosion = document.getElementById('audExplosion');
  const audTWin      = document.getElementById('audTWin');

  // optional: common volume
  [audPlanted,audDefused,audCTWin,audExplosion,audTWin].forEach(a=>a.volume=0.9);

  // ------------------------- state vars ---------------------------------
  let holdTimer   = null;   // 5-сек дарсан эсэх
  let planted     = false;
  let secondsLeft = 40;
  let countdownId = null;

  // ------------------------- helpers ------------------------------------
  function startShortBeep(){
    // 0.08 с “bip” – Web Audio oscillator (илүү хөнгөн, latency байхгүй)
    const ctx = new (window.AudioContext||window.webkitAudioContext)();
    const osc = ctx.createOscillator();
    const gain= ctx.createGain();
    osc.frequency.value = 1000;
    gain.gain.value = 0.1;
    osc.connect(gain).connect(ctx.destination);
    osc.start();
    setTimeout(()=>{osc.stop(); ctx.close();},80);
  }

  function updateDisp(){ display.textContent = secondsLeft.toString().padStart(2,'0'); }

  function beginHold(btn,cb){
    btn.addEventListener('mousedown',start);
    btn.addEventListener('touchstart',start,{passive:false});
    btn.addEventListener('mouseup',cancel);
    btn.addEventListener('mouseleave',cancel);
    btn.addEventListener('touchend',cancel);
    btn.addEventListener('touchcancel',cancel);

    function start(e){
      e.preventDefault();
      if(holdTimer || (planted && btn===plantBtn)) return;
      holdTimer = setTimeout(()=>{cb();holdTimer=null;},5000);
    }
    function cancel(){clearTimeout(holdTimer);holdTimer=null;}
  }

  // ------------------------- main actions -------------------------------
  function plantBomb(){
    planted = true;
    audPlanted.play();
    plantBtn.disabled = true;
    defuseBtn.disabled = false;
    secondsLeft = 40;
    updateDisp();

    countdownId = setInterval(()=>{
      secondsLeft--;
      startShortBeep();
      updateDisp();
      if(secondsLeft<=0) explode();
    },1000);
  }

  function defuseBomb(){
    if(!planted) return;
    clearInterval(countdownId);
    planted=false;
    audDefused.play();
    audDefused.onended = ()=> audCTWin.play();
    resetAfter(3000);     // 3 сек дараа UI-г анхны байдалд
  }

  function explode(){
    clearInterval(countdownId);
    planted=false;
    audExplosion.play();
    setTimeout(()=>audTWin.play(),800);  // тэсрэлт дундажаар ~0.8 с, дараа нь “T win”
    display.textContent="BOOM!";
    resetAfter(3500);
  }

  function resetAfter(ms){
    setTimeout(()=>{
      plantBtn.disabled=false;
      defuseBtn.disabled=true;
      display.textContent="Hold to PLANT";
    },ms);
  }

  // ------------------------- init ---------------------------------------
  beginHold(plantBtn,plantBomb);
  beginHold(defuseBtn,defuseBomb);
  </script>
</body>
</html>